{"version":3,"file":"ChatBox-Bicireb3.js","sources":["../../node_modules/framer-motion/dist/es/components/AnimatePresence/PopChild.mjs","../../node_modules/framer-motion/dist/es/components/AnimatePresence/PresenceChild.mjs","../../node_modules/framer-motion/dist/es/components/AnimatePresence/utils.mjs","../../node_modules/framer-motion/dist/es/components/AnimatePresence/index.mjs","../../node_modules/zustand/esm/vanilla.mjs","../../node_modules/zustand/esm/react.mjs","../../src/stores/authStore.ts","../../src/components/feature/VoiceChat.tsx","../../src/components/feature/VoiceSelector.tsx","../../src/components/feature/ChatBox.tsx"],"sourcesContent":["\"use client\";\nimport { jsx } from 'react/jsx-runtime';\nimport { isHTMLElement } from 'motion-dom';\nimport * as React from 'react';\nimport { useId, useRef, useContext, useInsertionEffect } from 'react';\nimport { MotionConfigContext } from '../../context/MotionConfigContext.mjs';\n\n/**\n * Measurement functionality has to be within a separate component\n * to leverage snapshot lifecycle.\n */\nclass PopChildMeasure extends React.Component {\n    getSnapshotBeforeUpdate(prevProps) {\n        const element = this.props.childRef.current;\n        if (element && prevProps.isPresent && !this.props.isPresent) {\n            const parent = element.offsetParent;\n            const parentWidth = isHTMLElement(parent)\n                ? parent.offsetWidth || 0\n                : 0;\n            const size = this.props.sizeRef.current;\n            size.height = element.offsetHeight || 0;\n            size.width = element.offsetWidth || 0;\n            size.top = element.offsetTop;\n            size.left = element.offsetLeft;\n            size.right = parentWidth - size.width - size.left;\n        }\n        return null;\n    }\n    /**\n     * Required with getSnapshotBeforeUpdate to stop React complaining.\n     */\n    componentDidUpdate() { }\n    render() {\n        return this.props.children;\n    }\n}\nfunction PopChild({ children, isPresent, anchorX, root }) {\n    const id = useId();\n    const ref = useRef(null);\n    const size = useRef({\n        width: 0,\n        height: 0,\n        top: 0,\n        left: 0,\n        right: 0,\n    });\n    const { nonce } = useContext(MotionConfigContext);\n    /**\n     * We create and inject a style block so we can apply this explicit\n     * sizing in a non-destructive manner by just deleting the style block.\n     *\n     * We can't apply size via render as the measurement happens\n     * in getSnapshotBeforeUpdate (post-render), likewise if we apply the\n     * styles directly on the DOM node, we might be overwriting\n     * styles set via the style prop.\n     */\n    useInsertionEffect(() => {\n        const { width, height, top, left, right } = size.current;\n        if (isPresent || !ref.current || !width || !height)\n            return;\n        const x = anchorX === \"left\" ? `left: ${left}` : `right: ${right}`;\n        ref.current.dataset.motionPopId = id;\n        const style = document.createElement(\"style\");\n        if (nonce)\n            style.nonce = nonce;\n        const parent = root ?? document.head;\n        parent.appendChild(style);\n        if (style.sheet) {\n            style.sheet.insertRule(`\n          [data-motion-pop-id=\"${id}\"] {\n            position: absolute !important;\n            width: ${width}px !important;\n            height: ${height}px !important;\n            ${x}px !important;\n            top: ${top}px !important;\n          }\n        `);\n        }\n        return () => {\n            if (parent.contains(style)) {\n                parent.removeChild(style);\n            }\n        };\n    }, [isPresent]);\n    return (jsx(PopChildMeasure, { isPresent: isPresent, childRef: ref, sizeRef: size, children: React.cloneElement(children, { ref }) }));\n}\n\nexport { PopChild };\n","\"use client\";\nimport { jsx } from 'react/jsx-runtime';\nimport * as React from 'react';\nimport { useId, useMemo } from 'react';\nimport { PresenceContext } from '../../context/PresenceContext.mjs';\nimport { useConstant } from '../../utils/use-constant.mjs';\nimport { PopChild } from './PopChild.mjs';\n\nconst PresenceChild = ({ children, initial, isPresent, onExitComplete, custom, presenceAffectsLayout, mode, anchorX, root }) => {\n    const presenceChildren = useConstant(newChildrenMap);\n    const id = useId();\n    let isReusedContext = true;\n    let context = useMemo(() => {\n        isReusedContext = false;\n        return {\n            id,\n            initial,\n            isPresent,\n            custom,\n            onExitComplete: (childId) => {\n                presenceChildren.set(childId, true);\n                for (const isComplete of presenceChildren.values()) {\n                    if (!isComplete)\n                        return; // can stop searching when any is incomplete\n                }\n                onExitComplete && onExitComplete();\n            },\n            register: (childId) => {\n                presenceChildren.set(childId, false);\n                return () => presenceChildren.delete(childId);\n            },\n        };\n    }, [isPresent, presenceChildren, onExitComplete]);\n    /**\n     * If the presence of a child affects the layout of the components around it,\n     * we want to make a new context value to ensure they get re-rendered\n     * so they can detect that layout change.\n     */\n    if (presenceAffectsLayout && isReusedContext) {\n        context = { ...context };\n    }\n    useMemo(() => {\n        presenceChildren.forEach((_, key) => presenceChildren.set(key, false));\n    }, [isPresent]);\n    /**\n     * If there's no `motion` components to fire exit animations, we want to remove this\n     * component immediately.\n     */\n    React.useEffect(() => {\n        !isPresent &&\n            !presenceChildren.size &&\n            onExitComplete &&\n            onExitComplete();\n    }, [isPresent]);\n    if (mode === \"popLayout\") {\n        children = (jsx(PopChild, { isPresent: isPresent, anchorX: anchorX, root: root, children: children }));\n    }\n    return (jsx(PresenceContext.Provider, { value: context, children: children }));\n};\nfunction newChildrenMap() {\n    return new Map();\n}\n\nexport { PresenceChild };\n","import { Children, isValidElement } from 'react';\n\nconst getChildKey = (child) => child.key || \"\";\nfunction onlyElements(children) {\n    const filtered = [];\n    // We use forEach here instead of map as map mutates the component key by preprending `.$`\n    Children.forEach(children, (child) => {\n        if (isValidElement(child))\n            filtered.push(child);\n    });\n    return filtered;\n}\n\nexport { getChildKey, onlyElements };\n","\"use client\";\nimport { jsx, Fragment } from 'react/jsx-runtime';\nimport { useMemo, useRef, useState, useContext } from 'react';\nimport { LayoutGroupContext } from '../../context/LayoutGroupContext.mjs';\nimport { useConstant } from '../../utils/use-constant.mjs';\nimport { useIsomorphicLayoutEffect } from '../../utils/use-isomorphic-effect.mjs';\nimport { PresenceChild } from './PresenceChild.mjs';\nimport { usePresence } from './use-presence.mjs';\nimport { onlyElements, getChildKey } from './utils.mjs';\n\n/**\n * `AnimatePresence` enables the animation of components that have been removed from the tree.\n *\n * When adding/removing more than a single child, every child **must** be given a unique `key` prop.\n *\n * Any `motion` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { motion, AnimatePresence } from 'framer-motion'\n *\n * export const Items = ({ items }) => (\n *   <AnimatePresence>\n *     {items.map(item => (\n *       <motion.div\n *         key={item.id}\n *         initial={{ opacity: 0 }}\n *         animate={{ opacity: 1 }}\n *         exit={{ opacity: 0 }}\n *       />\n *     ))}\n *   </AnimatePresence>\n * )\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * If a child contains multiple `motion` components with `exit` props, it will only unmount the child\n * once all `motion` components have finished animating out. Likewise, any components using\n * `usePresence` all need to call `safeToRemove`.\n *\n * @public\n */\nconst AnimatePresence = ({ children, custom, initial = true, onExitComplete, presenceAffectsLayout = true, mode = \"sync\", propagate = false, anchorX = \"left\", root }) => {\n    const [isParentPresent, safeToRemove] = usePresence(propagate);\n    /**\n     * Filter any children that aren't ReactElements. We can only track components\n     * between renders with a props.key.\n     */\n    const presentChildren = useMemo(() => onlyElements(children), [children]);\n    /**\n     * Track the keys of the currently rendered children. This is used to\n     * determine which children are exiting.\n     */\n    const presentKeys = propagate && !isParentPresent ? [] : presentChildren.map(getChildKey);\n    /**\n     * If `initial={false}` we only want to pass this to components in the first render.\n     */\n    const isInitialRender = useRef(true);\n    /**\n     * A ref containing the currently present children. When all exit animations\n     * are complete, we use this to re-render the component with the latest children\n     * *committed* rather than the latest children *rendered*.\n     */\n    const pendingPresentChildren = useRef(presentChildren);\n    /**\n     * Track which exiting children have finished animating out.\n     */\n    const exitComplete = useConstant(() => new Map());\n    /**\n     * Save children to render as React state. To ensure this component is concurrent-safe,\n     * we check for exiting children via an effect.\n     */\n    const [diffedChildren, setDiffedChildren] = useState(presentChildren);\n    const [renderedChildren, setRenderedChildren] = useState(presentChildren);\n    useIsomorphicLayoutEffect(() => {\n        isInitialRender.current = false;\n        pendingPresentChildren.current = presentChildren;\n        /**\n         * Update complete status of exiting children.\n         */\n        for (let i = 0; i < renderedChildren.length; i++) {\n            const key = getChildKey(renderedChildren[i]);\n            if (!presentKeys.includes(key)) {\n                if (exitComplete.get(key) !== true) {\n                    exitComplete.set(key, false);\n                }\n            }\n            else {\n                exitComplete.delete(key);\n            }\n        }\n    }, [renderedChildren, presentKeys.length, presentKeys.join(\"-\")]);\n    const exitingChildren = [];\n    if (presentChildren !== diffedChildren) {\n        let nextChildren = [...presentChildren];\n        /**\n         * Loop through all the currently rendered components and decide which\n         * are exiting.\n         */\n        for (let i = 0; i < renderedChildren.length; i++) {\n            const child = renderedChildren[i];\n            const key = getChildKey(child);\n            if (!presentKeys.includes(key)) {\n                nextChildren.splice(i, 0, child);\n                exitingChildren.push(child);\n            }\n        }\n        /**\n         * If we're in \"wait\" mode, and we have exiting children, we want to\n         * only render these until they've all exited.\n         */\n        if (mode === \"wait\" && exitingChildren.length) {\n            nextChildren = exitingChildren;\n        }\n        setRenderedChildren(onlyElements(nextChildren));\n        setDiffedChildren(presentChildren);\n        /**\n         * Early return to ensure once we've set state with the latest diffed\n         * children, we can immediately re-render.\n         */\n        return null;\n    }\n    if (process.env.NODE_ENV !== \"production\" &&\n        mode === \"wait\" &&\n        renderedChildren.length > 1) {\n        console.warn(`You're attempting to animate multiple children within AnimatePresence, but its mode is set to \"wait\". This will lead to odd visual behaviour.`);\n    }\n    /**\n     * If we've been provided a forceRender function by the LayoutGroupContext,\n     * we can use it to force a re-render amongst all surrounding components once\n     * all components have finished animating out.\n     */\n    const { forceRender } = useContext(LayoutGroupContext);\n    return (jsx(Fragment, { children: renderedChildren.map((child) => {\n            const key = getChildKey(child);\n            const isPresent = propagate && !isParentPresent\n                ? false\n                : presentChildren === renderedChildren ||\n                    presentKeys.includes(key);\n            const onExit = () => {\n                if (exitComplete.has(key)) {\n                    exitComplete.set(key, true);\n                }\n                else {\n                    return;\n                }\n                let isEveryExitComplete = true;\n                exitComplete.forEach((isExitComplete) => {\n                    if (!isExitComplete)\n                        isEveryExitComplete = false;\n                });\n                if (isEveryExitComplete) {\n                    forceRender?.();\n                    setRenderedChildren(pendingPresentChildren.current);\n                    propagate && safeToRemove?.();\n                    onExitComplete && onExitComplete();\n                }\n            };\n            return (jsx(PresenceChild, { isPresent: isPresent, initial: !isInitialRender.current || initial\n                    ? undefined\n                    : false, custom: custom, presenceAffectsLayout: presenceAffectsLayout, mode: mode, root: root, onExitComplete: isPresent ? undefined : onExit, anchorX: anchorX, children: child }, key));\n        }) }));\n};\n\nexport { AnimatePresence };\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const api = { setState, getState, getInitialState, subscribe };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = ((createState) => createState ? createStoreImpl(createState) : createStoreImpl);\n\nexport { createStore };\n","import React from 'react';\nimport { createStore } from 'zustand/vanilla';\n\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity) {\n  const slice = React.useSyncExternalStore(\n    api.subscribe,\n    React.useCallback(() => selector(api.getState()), [api, selector]),\n    React.useCallback(() => selector(api.getInitialState()), [api, selector])\n  );\n  React.useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  const api = createStore(createState);\n  const useBoundStore = (selector) => useStore(api, selector);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = ((createState) => createState ? createImpl(createState) : createImpl);\n\nexport { create, useStore };\n","import { create } from 'zustand';\r\nimport { supabase, authHelpers } from '../lib/supabase';\r\nimport type { User } from '@supabase/supabase-js';\r\n\r\ninterface Profile {\r\n  id: string;\r\n  full_name: string | null;\r\n  display_name: string | null;\r\n  email: string | null;\r\n  avatar_url: string | null;\r\n  location: string | null;\r\n  bio: string | null;\r\n  rating: number;\r\n  is_verified: boolean;\r\n}\r\n\r\ninterface CustomUser {\r\n  id: string;\r\n  phone: string;\r\n  email: string;\r\n  full_name: string;\r\n  is_active: boolean;\r\n}\r\n\r\ninterface AuthState {\r\n  user: User | null;\r\n  customUser: CustomUser | null;\r\n  profile: Profile | null;\r\n  isLoading: boolean;\r\n  isAuthenticated: boolean;\r\n  \r\n  // Actions\r\n  signIn: (email: string, password: string) => Promise<{ success: boolean; error?: string }>;\r\n  signUp: (email: string, password: string, fullName: string) => Promise<{ success: boolean; error?: string }>;\r\n  signOut: () => Promise<void>;\r\n  loadUser: () => Promise<void>;\r\n  updateProfile: (updates: Partial<Profile>) => Promise<{ success: boolean; error?: string }>;\r\n  verifySession: () => Promise<boolean>;\r\n  checkAuth: () => Promise<boolean>;\r\n}\r\n\r\nexport const useAuthStore = create<AuthState>((set, get) => ({\r\n  user: null,\r\n  customUser: null,\r\n  profile: null,\r\n  isLoading: true,\r\n  isAuthenticated: false,\r\n\r\n  // Session doƒürulama (WhatsApp i√ßin)\r\n  verifySession: async () => {\r\n    try {\r\n      const sessionToken = localStorage.getItem('session_token');\r\n      const userId = localStorage.getItem('user_id');\r\n\r\n      if (!sessionToken || !userId) {\r\n        return false;\r\n      }\r\n\r\n      const { data, error } = await supabase.functions.invoke('auth-verify', {\r\n        body: { session_token: sessionToken }\r\n      });\r\n\r\n      if (error || !data.success) {\r\n        localStorage.removeItem('session_token');\r\n        localStorage.removeItem('user_id');\r\n        set({\r\n          customUser: null,\r\n          isAuthenticated: false,\r\n        });\r\n        return false;\r\n      }\r\n\r\n      // Kullanƒ±cƒ± bilgilerini al\r\n      const { data: userData } = await supabase\r\n        .from('users')\r\n        .select('*')\r\n        .eq('id', userId)\r\n        .single();\r\n\r\n      if (userData) {\r\n        set({\r\n          customUser: userData,\r\n          isAuthenticated: true,\r\n        });\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  },\r\n\r\n  // Auth kontrol√º (hem Supabase hem custom session)\r\n  checkAuth: async () => {\r\n    try {\r\n      // √ñnce custom session kontrol et\r\n      const sessionToken = localStorage.getItem('session_token');\r\n      if (sessionToken) {\r\n        const isValid = await get().verifySession();\r\n        return isValid;\r\n      }\r\n\r\n      // Supabase auth kontrol et\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (user) {\r\n        set({\r\n          user,\r\n          isAuthenticated: true,\r\n        });\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  },\r\n\r\n  signIn: async (email: string, password: string) => {\r\n    try {\r\n      const { data, error } = await authHelpers.signIn(email, password);\r\n      \r\n      if (error) {\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      if (data.user) {\r\n        // Profil bilgilerini getir\r\n        const { data: profileData } = await supabase\r\n          .from('profiles')\r\n          .select('*')\r\n          .eq('id', data.user.id)\r\n          .single();\r\n\r\n        set({\r\n          user: data.user,\r\n          profile: profileData,\r\n          isAuthenticated: true,\r\n        });\r\n      }\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error: 'Giri≈ü yapƒ±lƒ±rken bir hata olu≈ütu' };\r\n    }\r\n  },\r\n\r\n  signUp: async (email: string, password: string, fullName: string) => {\r\n    try {\r\n      const { data, error } = await authHelpers.signUp(email, password, fullName);\r\n      \r\n      if (error) {\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      if (data.user) {\r\n        // Profil olu≈ütur\r\n        await supabase.from('profiles').insert({\r\n          id: data.user.id,\r\n          email: data.user.email,\r\n          full_name: fullName,\r\n          display_name: fullName,\r\n          is_verified: false,\r\n          rating: 0,\r\n        });\r\n\r\n        set({\r\n          user: data.user,\r\n          isAuthenticated: true,\r\n        });\r\n      }\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error: 'Kayƒ±t olurken bir hata olu≈ütu' };\r\n    }\r\n  },\r\n\r\n  signOut: async () => {\r\n    // Custom session temizle\r\n    localStorage.removeItem('session_token');\r\n    localStorage.removeItem('user_id');\r\n    \r\n    // Supabase session temizle\r\n    await authHelpers.signOut();\r\n    \r\n    set({\r\n      user: null,\r\n      customUser: null,\r\n      profile: null,\r\n      isAuthenticated: false,\r\n    });\r\n  },\r\n\r\n  loadUser: async () => {\r\n    try {\r\n      set({ isLoading: true });\r\n      \r\n      // √ñnce custom session kontrol et\r\n      const sessionToken = localStorage.getItem('session_token');\r\n      const userId = localStorage.getItem('user_id');\r\n\r\n      if (sessionToken && userId) {\r\n        const isValid = await get().verifySession();\r\n        if (isValid) {\r\n          set({ isLoading: false });\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Supabase auth kontrol et\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (user) {\r\n        // Profil bilgilerini getir\r\n        const { data: profileData } = await supabase\r\n          .from('profiles')\r\n          .select('*')\r\n          .eq('id', user.id)\r\n          .single();\r\n\r\n        set({\r\n          user,\r\n          profile: profileData,\r\n          isAuthenticated: true,\r\n          isLoading: false,\r\n        });\r\n      } else {\r\n        set({\r\n          user: null,\r\n          customUser: null,\r\n          profile: null,\r\n          isAuthenticated: false,\r\n          isLoading: false,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      set({\r\n        user: null,\r\n        customUser: null,\r\n        profile: null,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n      });\r\n    }\r\n  },\r\n\r\n  updateProfile: async (updates: Partial<Profile>) => {\r\n    try {\r\n      const { user } = get();\r\n      if (!user) {\r\n        return { success: false, error: 'Kullanƒ±cƒ± giri≈üi gerekli' };\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .update(updates)\r\n        .eq('id', user.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      set({ profile: data });\r\n      return { success: true };\r\n    } catch (error) {\r\n      return { success: false, error: 'Profil g√ºncellenirken bir hata olu≈ütu' };\r\n    }\r\n  },\r\n}));\r\n\r\n// Auth state deƒüi≈üikliklerini dinle\r\nsupabase.auth.onAuthStateChange((event, session) => {\r\n  if (event === 'SIGNED_IN' && session?.user) {\r\n    useAuthStore.getState().loadUser();\r\n  } else if (event === 'SIGNED_OUT') {\r\n    useAuthStore.setState({\r\n      user: null,\r\n      customUser: null,\r\n      profile: null,\r\n      isAuthenticated: false,\r\n    });\r\n  }\r\n});\r\n","import { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface VoiceChatProps {\r\n  onTranscriptReady: (text: string) => void;\r\n  onResponseReceived?: (text: string) => void;\r\n  isEnabled?: boolean;\r\n  selectedVoice?: SpeechSynthesisVoice | null;\r\n}\r\n\r\nexport default function VoiceChat({\r\n  onTranscriptReady,\r\n  onResponseReceived,\r\n  isEnabled = true,\r\n  selectedVoice: externalSelectedVoice = null\r\n}: VoiceChatProps) {\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [transcript, setTranscript] = useState('');\r\n  const [correctedText, setCorrectedText] = useState('');\r\n  const [isCorrecting, setIsCorrecting] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isSpeaking, setIsSpeaking] = useState(false);\r\n  const [internalSelectedVoice, setInternalSelectedVoice] = useState<SpeechSynthesisVoice | null>(null);\r\n  \r\n  // Use external voice if provided, otherwise use internal\r\n  const selectedVoice = externalSelectedVoice || internalSelectedVoice;\r\n\r\n  const recognitionRef = useRef<any>(null);\r\n  const synthRef = useRef<SpeechSynthesis | null>(null);\r\n\r\n  useEffect(() => {\r\n    // Initialize Speech Recognition\r\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\r\n      const SpeechRecognition = (window as any).webkitSpeechRecognition || (window as any).SpeechRecognition;\r\n      recognitionRef.current = new SpeechRecognition();\r\n      recognitionRef.current.lang = 'tr-TR';\r\n      recognitionRef.current.continuous = true;  // Keep listening for longer\r\n      recognitionRef.current.interimResults = true;  // Show partial results\r\n\r\n      recognitionRef.current.onresult = async (event: any) => {\r\n        // Get final transcript (when user stops speaking)\r\n        let finalTranscript = '';\r\n        for (let i = 0; i < event.results.length; i++) {\r\n          if (event.results[i].isFinal) {\r\n            finalTranscript += event.results[i][0].transcript;\r\n          }\r\n        }\r\n        \r\n        if (finalTranscript) {\r\n          setTranscript(finalTranscript);\r\n          // Quick brand correction (frontend only - no backend call)\r\n          const corrected = correctBrandNames(finalTranscript);\r\n          setCorrectedText(corrected);\r\n          onTranscriptReady(corrected);\r\n          // Auto-stop after getting final result\r\n          stopListening();\r\n        }\r\n      };\r\n\r\n      recognitionRef.current.onerror = (event: any) => {\r\n        console.error('Speech recognition error:', event.error);\r\n        setError(`Ses tanƒ±ma hatasƒ±: ${event.error}`);\r\n        setIsListening(false);\r\n      };\r\n\r\n      recognitionRef.current.onend = () => {\r\n        setIsListening(false);\r\n      };\r\n    } else {\r\n      setError('Tarayƒ±cƒ±nƒ±z ses tanƒ±mayƒ± desteklemiyor. Chrome veya Edge kullanƒ±n.');\r\n    }\r\n\r\n    // Initialize Speech Synthesis\r\n    synthRef.current = window.speechSynthesis;\r\n    \r\n    // Auto-select default voice if not provided externally\r\n    if (!externalSelectedVoice) {\r\n      const loadDefaultVoice = () => {\r\n        const availableVoices = synthRef.current?.getVoices() || [];\r\n        const turkishVoices = availableVoices.filter(v => v.lang.startsWith('tr'));\r\n        if (turkishVoices.length > 0 && !internalSelectedVoice) {\r\n          // Prefer Emel (female) or other quality voices over Tolga (has audio issues)\r\n          const preferredVoice = turkishVoices.find(v => v.name.includes('Emel')) ||\r\n                                 turkishVoices.find(v => v.name.toLowerCase().includes('female')) ||\r\n                                 turkishVoices[turkishVoices.length > 1 ? 1 : 0]; // Skip first if multiple available\r\n          setInternalSelectedVoice(preferredVoice);\r\n          console.log('üé§ Default voice selected:', preferredVoice.name);\r\n        }\r\n      };\r\n      loadDefaultVoice();\r\n      setTimeout(loadDefaultVoice, 100);\r\n      if (synthRef.current) {\r\n        synthRef.current.onvoiceschanged = loadDefaultVoice;\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (recognitionRef.current) {\r\n        recognitionRef.current.stop();\r\n      }\r\n      if (synthRef.current) {\r\n        synthRef.current.cancel();\r\n      }\r\n    };\r\n  }, [selectedVoice]);\r\n\r\n  const startListening = () => {\r\n    if (!isEnabled) return;\r\n    \r\n    setError(null);\r\n    setTranscript('');\r\n    setCorrectedText('');\r\n    \r\n    if (recognitionRef.current) {\r\n      try {\r\n        recognitionRef.current.start();\r\n        setIsListening(true);\r\n      } catch (err) {\r\n        console.error('Failed to start recognition:', err);\r\n        setError('Mikrofon ba≈ülatƒ±lamadƒ±. ƒ∞zin verdiƒüinizden emin olun.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const stopListening = () => {\r\n    if (recognitionRef.current) {\r\n      recognitionRef.current.stop();\r\n    }\r\n    setIsListening(false);\r\n  };\r\n\r\n  // Convert numbers to Turkish words for better TTS\r\n  const convertNumberToWords = (num: number): string => {\r\n    const ones = ['', 'bir', 'iki', '√º√ß', 'd√∂rt', 'be≈ü', 'altƒ±', 'yedi', 'sekiz', 'dokuz'];\r\n    const tens = ['', 'on', 'yirmi', 'otuz', 'kƒ±rk', 'elli', 'altmƒ±≈ü', 'yetmi≈ü', 'seksen', 'doksan'];\r\n    const hundreds = ['', 'y√ºz', 'iki y√ºz', '√º√ß y√ºz', 'd√∂rt y√ºz', 'be≈ü y√ºz', 'altƒ± y√ºz', 'yedi y√ºz', 'sekiz y√ºz', 'dokuz y√ºz'];\r\n    \r\n    if (num === 0) return 'sƒ±fƒ±r';\r\n    if (num < 10) return ones[num];\r\n    if (num < 100) {\r\n      const ten = Math.floor(num / 10);\r\n      const one = num % 10;\r\n      return tens[ten] + (one > 0 ? ' ' + ones[one] : '');\r\n    }\r\n    if (num < 1000) {\r\n      const hundred = Math.floor(num / 100);\r\n      const remainder = num % 100;\r\n      return hundreds[hundred] + (remainder > 0 ? ' ' + convertNumberToWords(remainder) : '');\r\n    }\r\n    return num.toString(); // Fallback for very large numbers\r\n  };\r\n\r\n  const correctBrandNames = (text: string): string => {\r\n    // Fast brand name correction (no backend call needed)\r\n    const brandMap: Record<string, string> = {\r\n      // Otomotiv\r\n      'sitroen': 'Citroen', 'citron': 'Citroen', 'stroen': 'Citroen',\r\n      'reno': 'Renault', 'por≈üe': 'Porsche', 'mersedes': 'Mercedes',\r\n      'bƒ±mvƒ±': 'BMW', 'foksvagen': 'Volkswagen', 'toyta': 'Toyota',\r\n      'pejo': 'Peugeot', 'hundai': 'Hyundai',\r\n      // Elektronik\r\n      'ayfon': 'iPhone', 'aypad': 'iPad', 'samsƒ±ng': 'Samsung',\r\n      'huavey': 'Huawei', '≈üiyomi': 'Xiaomi',\r\n      // Parf√ºm\r\n      'kelvin klein': 'Calvin Klein', 'calvin klein': 'Calvin Klein',\r\n      'selin dion': 'Celine Dion', 'selin diyor': 'Celine Dior',\r\n      'poison': 'Poison', 'poyzƒ±n': 'Poison',\r\n      'diyor': 'Dior', '≈üanel': 'Chanel', 'lank√∂m': 'Lanc√¥me',\r\n      'gucci': 'Gucci', 'versa√ße': 'Versace', 'hugo boss': 'Hugo Boss',\r\n      'lakost': 'Lacoste', 'lakos': 'Lacoste', 'lagos': 'Lacoste'\r\n    };\r\n\r\n    let corrected = text;\r\n    for (const [wrong, correct] of Object.entries(brandMap)) {\r\n      const regex = new RegExp(`\\\\b${wrong}\\\\b`, 'gi');\r\n      corrected = corrected.replace(regex, correct);\r\n    }\r\n    \r\n    return corrected;\r\n  };\r\n\r\n  const speak = useCallback((text: string) => {\r\n    if (!synthRef.current || !isEnabled) return;\r\n\r\n    // Clean text for voice (remove emojis, URLs, and technical content)\r\n    let cleanText = text;\r\n\r\n    // Normalize cases where digits are attached to words so TTS can read them.\r\n    // Examples: \"iPhone13\" -> \"iPhone 13\", \"ilan1\" -> \"ilan 1\"\r\n    // Keep it language-agnostic (works for TR + EN brand names).\r\n    cleanText = cleanText\r\n      .replace(/([A-Za-z√áƒûƒ∞√ñ≈û√ú√ßƒüƒ±√∂≈ü√ºƒ∞ƒ±]+)(\\d+)/g, '$1 $2')\r\n      .replace(/(\\d+)([A-Za-z√áƒûƒ∞√ñ≈û√ú√ßƒüƒ±√∂≈ü√ºƒ∞ƒ±]+)/g, '$1 $2');\r\n\r\n    // Normalize \"1 nolu\" / \"1'nolu\" forms into a speak-friendly phrase.\r\n    // Example: \"1 nolu ilan\" -> \"bir numaralƒ± ilan\"\r\n    cleanText = cleanText.replace(/\\b(\\d{1,3})\\s*'?nolu\\b/gi, (_match, num) => {\r\n      const n = parseInt(num, 10);\r\n      if (Number.isFinite(n)) return `${convertNumberToWords(n)} numaralƒ±`;\r\n      return `${num} numaralƒ±`;\r\n    });\r\n\r\n    // Convert short model/ordinal numbers after a word for better Turkish TTS.\r\n    // Example: \"iPhone 12\" -> \"iPhone on iki\"\r\n    cleanText = cleanText.replace(/([A-Za-z√áƒûƒ∞√ñ≈û√ú√ßƒüƒ±√∂≈ü√ºƒ∞ƒ±]{2,})\\s+(\\d{1,2})\\b/g, (_match, word, num) => {\r\n      const n = parseInt(num, 10);\r\n      if (Number.isFinite(n)) return `${word} ${convertNumberToWords(n)}`;\r\n      return `${word} ${num}`;\r\n    });\r\n    \r\n    // Format Turkish phone numbers for voice (multiple formats)\r\n    // +905412879705 ‚Üí \"sƒ±fƒ±r be≈ü d√∂rt bir, iki sekiz yedi, doksan yedi sƒ±fƒ±r be≈ü\"\r\n    cleanText = cleanText.replace(/\\+90(\\d{3})(\\d{3})(\\d{4})/g, (match, p1, p2, p3) => {\r\n      const digits = ['sƒ±fƒ±r', 'bir', 'iki', '√º√ß', 'd√∂rt', 'be≈ü', 'altƒ±', 'yedi', 'sekiz', 'dokuz'];\r\n      const part1 = p1.split('').map(d => digits[parseInt(d)]).join(' ');\r\n      const part2 = p2.split('').map(d => digits[parseInt(d)]).join(' ');\r\n      const part3 = p3.split('').map(d => digits[parseInt(d)]).join(' ');\r\n      return `telefon: ${part1}, ${part2}, ${part3}`;\r\n    });\r\n    \r\n    // Also format phone without +90\r\n    cleanText = cleanText.replace(/\\b0(\\d{3})(\\d{3})(\\d{4})\\b/g, (match, p1, p2, p3) => {\r\n      const digits = ['sƒ±fƒ±r', 'bir', 'iki', '√º√ß', 'd√∂rt', 'be≈ü', 'altƒ±', 'yedi', 'sekiz', 'dokuz'];\r\n      const part1 = p1.split('').map(d => digits[parseInt(d)]).join(' ');\r\n      const part2 = p2.split('').map(d => digits[parseInt(d)]).join(' ');\r\n      const part3 = p3.split('').map(d => digits[parseInt(d)]).join(' ');\r\n      return `telefon: ${part1}, ${part2}, ${part3}`;\r\n    });\r\n    \r\n    // Format other numbers (prices, counts, etc.) - read digit by digit for clarity\r\n    // Example: \"375.000 ‚Ç∫\" ‚Üí \"√º√ß y√ºz yetmi≈ü be≈ü bin lira\"\r\n    // But for simplicity, just read large numbers as-is, only format 3-6 digit numbers\r\n    cleanText = cleanText.replace(/\\b(\\d{3,6})\\s*(‚Ç∫|TL|lira)?\\b/gi, (match, num, currency) => {\r\n      const n = parseInt(num);\r\n      if (n >= 1000) {\r\n        // For large numbers, use Turkish number names\r\n        const thousands = Math.floor(n / 1000);\r\n        const remainder = n % 1000;\r\n        let result = '';\r\n        if (thousands > 0) {\r\n          result += `${thousands === 1 ? 'bin' : convertNumberToWords(thousands) + ' bin'}`;\r\n        }\r\n        if (remainder > 0) {\r\n          result += ` ${convertNumberToWords(remainder)}`;\r\n        }\r\n        return result + (currency ? ' lira' : '');\r\n      }\r\n      return convertNumberToWords(n) + (currency ? ' lira' : '');\r\n    });\r\n    \r\n    cleanText = cleanText\r\n      // Remove only URL lines (not following text)\r\n      .replace(/^https?:\\/\\/[^\\s]+$/gm, '')\r\n      // Remove \"Fotoƒüraflar:\" label only, keep following text\r\n      .replace(/Fotoƒüraflar:\\s*/g, '')\r\n      // Remove remaining inline URLs\r\n      .replace(/https?:\\/\\/[^\\s]+/g, '')\r\n      // Remove emojis\r\n      .replace(/[\\u{1F000}-\\u{1FFFF}]/gu, '')\r\n      .replace(/[\\u{2600}-\\u{27BF}]/gu, '')\r\n      .replace(/[\\u{FE0F}\\u{200D}]/gu, '')\r\n      // Remove number emojis (1Ô∏è‚É£, 2Ô∏è‚É£, etc.)\r\n      .replace(/\\d\\u{FE0F}?\\u{20E3}/gu, '')\r\n      // Simplify repeated listing titles in cards\r\n      .replace(/^\"([^\"]+)\"\\s*$/gm, '')\r\n      // Clean up multiple spaces and newlines\r\n      .replace(/\\n{3,}/g, '\\n\\n')\r\n      .replace(/\\s+/g, ' ')\r\n      .trim();\r\n\r\n    if (!cleanText) return;\r\n\r\n    // Cancel any ongoing speech immediately\r\n    synthRef.current.cancel();\r\n\r\n    const utterance = new SpeechSynthesisUtterance(cleanText);\r\n    utterance.lang = 'tr-TR';\r\n    utterance.rate = 1.1;  // Slightly faster for responsiveness\r\n    utterance.pitch = 1.0;\r\n    utterance.volume = 1.0;\r\n    \r\n    // Apply selected voice (pre-loaded)\r\n    if (selectedVoice) {\r\n      utterance.voice = selectedVoice;\r\n    }\r\n\r\n    utterance.onstart = () => setIsSpeaking(true);\r\n    utterance.onend = () => setIsSpeaking(false);\r\n    utterance.onerror = (e) => {\r\n      console.error('üîä Speech error:', e);\r\n      setIsSpeaking(false);\r\n    };\r\n\r\n    // Speak immediately without delay\r\n    synthRef.current.speak(utterance);\r\n  }, [isEnabled, selectedVoice]);\r\n\r\n  const stopSpeaking = () => {\r\n    if (synthRef.current) {\r\n      synthRef.current.cancel();\r\n      setIsSpeaking(false);\r\n    }\r\n  };\r\n\r\n  // Expose speak function to parent (always expose when enabled)\r\n  useEffect(() => {\r\n    if (isEnabled) {\r\n      console.log('‚úÖ VoiceChat: Exposing speak function');\r\n      (window as any).speakResponse = speak;\r\n    }\r\n    return () => {\r\n      console.log('üóëÔ∏è VoiceChat: Cleaning up speak function');\r\n      delete (window as any).speakResponse;\r\n    };\r\n  }, [isEnabled, speak]);\r\n\r\n  return (\r\n    <div className=\"voice-chat-container relative flex items-center gap-2\">\r\n      {/* Microphone Button */}\r\n      <motion.button\r\n        onClick={isListening ? stopListening : startListening}\r\n        disabled={!isEnabled || isCorrecting}\r\n        title={isListening ? \"Dinlemeyi Durdur\" : \"Konu≈ümaya Ba≈üla\"}\r\n        className={`relative w-10 h-10 rounded-full flex items-center justify-center transition-all ${\r\n          isListening\r\n            ? 'bg-red-500 hover:bg-red-600 shadow-lg shadow-red-500/50'\r\n            : 'bg-gradient-to-r from-purple-500 to-cyan-500 hover:shadow-lg hover:shadow-purple-500/50'\r\n        } ${!isEnabled || isCorrecting ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}`}\r\n        whileHover={{ scale: isEnabled && !isCorrecting ? 1.05 : 1 }}\r\n        whileTap={{ scale: isEnabled && !isCorrecting ? 0.95 : 1 }}\r\n        animate={isListening ? { scale: [1, 1.1, 1] } : {}}\r\n        transition={isListening ? { repeat: Infinity, duration: 1.5 } : {}}\r\n      >\r\n        <i className={`${isListening ? 'ri-stop-circle-line' : 'ri-mic-line'} text-xl text-white`} />\r\n        \r\n        {isListening && (\r\n          <motion.div\r\n            className=\"absolute inset-0 rounded-full border-2 border-red-300\"\r\n            animate={{ scale: [1, 1.5], opacity: [1, 0] }}\r\n            transition={{ repeat: Infinity, duration: 1.5 }}\r\n          />\r\n        )}\r\n      </motion.button>\r\n\r\n      {/* Status Indicators */}\r\n      <AnimatePresence>\r\n        {(transcript || correctedText || error || isCorrecting) && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -10 }}\r\n            className=\"absolute bottom-14 right-0 max-w-xs bg-white rounded-2xl shadow-2xl p-4 space-y-2 z-50\"\r\n          >\r\n            {error && (\r\n              <div className=\"text-sm text-red-600 flex items-start gap-2\">\r\n                <i className=\"ri-error-warning-line text-lg mt-0.5\" />\r\n                <span>{error}</span>\r\n              </div>\r\n            )}\r\n\r\n            {isCorrecting && (\r\n              <div className=\"text-sm text-gray-600 flex items-center gap-2\">\r\n                <i className=\"ri-loader-4-line text-lg animate-spin\" />\r\n                <span>Metin d√ºzeltiliyor...</span>\r\n              </div>\r\n            )}\r\n\r\n            {transcript && !isCorrecting && (\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-xs text-gray-500 font-medium\">Ham Metin:</div>\r\n                <div className=\"text-sm text-gray-700 italic\">{transcript}</div>\r\n              </div>\r\n            )}\r\n\r\n            {correctedText && !isCorrecting && (\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-xs text-green-600 font-medium flex items-center gap-1\">\r\n                  <i className=\"ri-check-line\" />\r\n                  D√ºzeltilmi≈ü:\r\n                </div>\r\n                <div className=\"text-sm text-gray-900 font-medium\">{correctedText}</div>\r\n              </div>\r\n            )}\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Speaker Control (when AI is speaking) */}\r\n      <AnimatePresence>\r\n        {isSpeaking && (\r\n          <motion.button\r\n            initial={{ opacity: 0, scale: 0.8 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            exit={{ opacity: 0, scale: 0.8 }}\r\n            onClick={stopSpeaking}\r\n            title=\"Konu≈ümayƒ± Durdur\"\r\n            className=\"absolute bottom-14 right-0 w-10 h-10 bg-orange-500 hover:bg-orange-600 rounded-full flex items-center justify-center shadow-lg cursor-pointer z-50\"\r\n          >\r\n            <i className=\"ri-volume-up-line text-lg text-white animate-pulse\" />\r\n          </motion.button>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface VoiceSelectorProps {\r\n  selectedVoice: SpeechSynthesisVoice | null;\r\n  onVoiceSelect: (voice: SpeechSynthesisVoice) => void;\r\n}\r\n\r\nexport default function VoiceSelector({ selectedVoice, onVoiceSelect }: VoiceSelectorProps) {\r\n  const [voices, setVoices] = useState<SpeechSynthesisVoice[]>([]);\r\n  const [showMenu, setShowMenu] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const loadVoices = () => {\r\n      const availableVoices = window.speechSynthesis?.getVoices() || [];\r\n      console.log('üé§ Available voices:', availableVoices.length, 'voices loaded');\r\n      \r\n      // Filter Turkish voices and exclude Tolga (has audio quality issues)\r\n      const turkishVoices = availableVoices.filter(v => \r\n        v.lang.startsWith('tr') && !v.name.toLowerCase().includes('tolga')\r\n      );\r\n      const voicesToUse = turkishVoices.length > 0 ? turkishVoices : \r\n        availableVoices.filter(v => !v.name.toLowerCase().includes('tolga'));\r\n      \r\n      console.log('üé§ Using', voicesToUse.length, 'voices for selection (Tolga filtered out)');\r\n      setVoices(voicesToUse);\r\n    };\r\n\r\n    // Voices might not be loaded immediately - try multiple times\r\n    loadVoices();\r\n    setTimeout(loadVoices, 100);\r\n    setTimeout(loadVoices, 500);\r\n    \r\n    if (window.speechSynthesis) {\r\n      window.speechSynthesis.onvoiceschanged = loadVoices;\r\n    }\r\n\r\n    return () => {\r\n      if (window.speechSynthesis) {\r\n        window.speechSynthesis.onvoiceschanged = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={() => setShowMenu(!showMenu)}\r\n        title={voices.length > 0 ? \"Ses Se√ßimi\" : \"Sesler y√ºkleniyor...\"}\r\n        className=\"w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors\"\r\n      >\r\n        <i className=\"ri-user-voice-line text-xl text-white/80\" />\r\n      </button>\r\n\r\n      {/* Voice Selection Menu */}\r\n      {showMenu && (\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.95, y: -10 }}\r\n          animate={{ opacity: 1, scale: 1, y: 0 }}\r\n          className=\"absolute top-12 right-0 bg-gray-800 rounded-lg shadow-xl p-3 w-[320px] max-h-[300px] overflow-y-auto overflow-x-hidden z-[9999]\"\r\n        >\r\n          <div className=\"text-xs text-gray-400 px-2 py-1 font-semibold border-b border-gray-700 mb-2\">\r\n            Ses Se√ßin: {voices.length > 0 ? `(${voices.length} ses)` : 'Y√ºkleniyor...'}\r\n          </div>\r\n          {voices.length === 0 ? (\r\n            <div className=\"px-3 py-2 text-sm text-gray-400\">\r\n              Sesler y√ºkleniyor...\r\n            </div>\r\n          ) : (\r\n            voices.map((voice, index) => {\r\n              const isFemale = voice.name.toLowerCase().includes('female') || \r\n                              voice.name.toLowerCase().includes('kadƒ±n') ||\r\n                              voice.name.toLowerCase().includes('woman') ||\r\n                              voice.name.toLowerCase().includes('emel');\r\n              const icon = isFemale ? '‚ôÄÔ∏è' : '‚ôÇÔ∏è';\r\n              \r\n              return (\r\n                <button\r\n                  key={index}\r\n                  onClick={() => {\r\n                    onVoiceSelect(voice);\r\n                    setShowMenu(false);\r\n                    console.log('üé§ Voice selected:', voice.name);\r\n                  }}\r\n                  className={`w-full px-4 py-2.5 rounded-md hover:bg-white/10 transition-all text-sm flex items-center gap-3 ${\r\n                    selectedVoice?.name === voice.name ? 'bg-purple-500/30 text-white font-medium' : 'text-gray-300'\r\n                  }`}\r\n                >\r\n                  <span className=\"text-base flex-shrink-0\">{icon}</span>\r\n                  <span className=\"flex-1 text-left leading-tight\">{voice.name}</span>\r\n                </button>\r\n              );\r\n            })\r\n          )}\r\n        </motion.div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useRef, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useAuthStore } from '../../stores/authStore';\r\nimport VoiceChat from './VoiceChat';\r\nimport VoiceSelector from './VoiceSelector';\r\n\r\ntype Message = {\r\n  id: string;\r\n  type: 'user' | 'ai';\r\n  content: string;\r\n  timestamp: Date;\r\n  listings?: any[]; // ƒ∞lan bilgileri i√ßin\r\n};\r\n\r\ntype Tab = 'general' | 'listing' | 'support';\r\n\r\n// Supabase client (public anon key for uploads to public bucket)\r\nconst supabaseUrl = import.meta.env.VITE_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = import.meta.env.VITE_PUBLIC_SUPABASE_ANON_KEY;\r\nconst supabase = createClient(supabaseUrl, supabaseAnonKey);\r\nconst PUBLIC_BUCKET = 'product-images';\r\n\r\n// Generate or retrieve unique user ID\r\nconst getUserId = (): string => {\r\n  let userId = localStorage.getItem('web_user_id');\r\n  if (!userId) {\r\n    userId = `web_user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    localStorage.setItem('web_user_id', userId);\r\n  }\r\n  return userId;\r\n};\r\n\r\n// Parse listing data from message\r\nconst parseListings = (content: string): { cleanContent: string; listings: any[] } => {\r\n  const searchCacheMatch = content.match(/\\[SEARCH_CACHE\\]({.*})/s);\r\n  if (searchCacheMatch) {\r\n    try {\r\n      const cacheData = JSON.parse(searchCacheMatch[1]);\r\n      const cleanContent = content.replace(/\\[SEARCH_CACHE\\].*$/s, '').trim();\r\n      return { cleanContent, listings: cacheData.results || [] };\r\n    } catch (e) {\r\n      console.error('Failed to parse listings:', e);\r\n    }\r\n  }\r\n  return { cleanContent: content, listings: [] };\r\n};\r\n\r\n// Resim sƒ±kƒ±≈ütƒ±rma fonksiyonu\r\nconst compressImage = async (file: File, maxSizeMB: number = 0.9): Promise<File> => {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = (event) => {\r\n      const img = new Image();\r\n      img.src = event.target?.result as string;\r\n      img.onload = () => {\r\n        const canvas = document.createElement('canvas');\r\n        let width = img.width;\r\n        let height = img.height;\r\n\r\n        // Maksimum boyut kontrol√º (uzun kenar max 1920px)\r\n        const maxDimension = 1920;\r\n        if (width > height && width > maxDimension) {\r\n          height = (height * maxDimension) / width;\r\n          width = maxDimension;\r\n        } else if (height > maxDimension) {\r\n          width = (width * maxDimension) / height;\r\n          height = maxDimension;\r\n        }\r\n\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        const ctx = canvas.getContext('2d');\r\n        ctx?.drawImage(img, 0, 0, width, height);\r\n\r\n        // Kalite ayarƒ± ile sƒ±kƒ±≈ütƒ±rma\r\n        let quality = 0.9;\r\n        const maxSizeBytes = maxSizeMB * 1024 * 1024;\r\n\r\n        const tryCompress = (q: number) => {\r\n          canvas.toBlob(\r\n            (blob) => {\r\n              if (!blob) {\r\n                reject(new Error('Resim sƒ±kƒ±≈ütƒ±rƒ±lamadƒ±'));\r\n                return;\r\n              }\r\n\r\n              // Eƒüer boyut hala b√ºy√ºkse, kaliteyi d√º≈ü√ºr\r\n              if (blob.size > maxSizeBytes && q > 0.1) {\r\n                tryCompress(q - 0.1);\r\n              } else {\r\n                const compressedFile = new File([blob], file.name, {\r\n                  type: 'image/jpeg',\r\n                  lastModified: Date.now(),\r\n                });\r\n                resolve(compressedFile);\r\n              }\r\n            },\r\n            'image/jpeg',\r\n            q\r\n          );\r\n        };\r\n\r\n        tryCompress(quality);\r\n      };\r\n      img.onerror = () => reject(new Error('Resim y√ºklenemedi'));\r\n    };\r\n    reader.onerror = () => reject(new Error('Dosya okunamadƒ±'));\r\n  });\r\n};\r\n\r\nexport default function ChatBox() {\r\n  const navigate = useNavigate();\r\n  const { user, customUser, profile, checkAuth } = useAuthStore();\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState<Tab>('listing');\r\n  const [messages, setMessages] = useState<Message[]>([\r\n    {\r\n      id: '1',\r\n      type: 'ai',\r\n      content: 'Merhaba! Ben PazarAI. Size nasƒ±l yardƒ±mcƒ± olabilirim? ƒ∞lan vermek i√ßin fotoƒüraf g√∂nderebilir veya √ºr√ºn√ºn√ºz√º anlatabilirsiniz.',\r\n      timestamp: new Date(),\r\n    },\r\n  ]);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [displayCount, setDisplayCount] = useState(3);\r\n  const [voiceMode, setVoiceMode] = useState(false);\r\n  const [selectedVoice, setSelectedVoice] = useState<SpeechSynthesisVoice | null>(null);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const currentMessageRef = useRef<string>('');\r\n  const conversationHistory = useRef<Array<{ role: string; content: string }>>([]);\r\n\r\n  const AGENT_BACKEND_URL = 'https://pazarglobal-agent-backend-production-4ec8.up.railway.app';\r\n\r\n  const resolveUserIdPath = (id: string) => id?.replace(/[^a-zA-Z0-9_-]/g, '') || 'web-user';\r\n\r\n  const uploadImageToSupabase = async (file: File, resolvedUserId: string) => {\r\n    const sanitizedUser = resolveUserIdPath(resolvedUserId);\r\n    const filename = `${crypto.randomUUID?.() || Date.now()}-${file.name.replace(/\\s+/g, '-')}`;\r\n    const storagePath = `${sanitizedUser}/${filename}`;\r\n    const { error } = await supabase.storage.from(PUBLIC_BUCKET).upload(storagePath, file, {\r\n      contentType: file.type,\r\n      upsert: false,\r\n    });\r\n    if (error) {\r\n      throw new Error(error.message);\r\n    }\r\n    const publicUrl = `${supabaseUrl}/storage/v1/object/public/${PUBLIC_BUCKET}/${storagePath}`;\r\n    return { storagePath, publicUrl };\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  // Try to hydrate auth context so agent backend can map the visitor to a real account\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, [checkAuth]);\r\n\r\n  const handleListingClick = (listingId: string) => {\r\n    navigate(`/listing/${listingId}`);\r\n    setIsOpen(false);\r\n  };\r\n\r\n  const sendMessageToAgent = async (message: string, options?: { mediaPaths?: string[]; mediaType?: string }) => {\r\n    setIsTyping(true);\r\n    setIsConnecting(true);\r\n    setError(null);\r\n    currentMessageRef.current = '';\r\n\r\n    const sessionToken = localStorage.getItem('session_token');\r\n    const storedUserId = localStorage.getItem('user_id');\r\n    const resolvedUserId = customUser?.id || user?.id || storedUserId || getUserId();\r\n    const userContext = {\r\n      user_id: resolvedUserId,\r\n      session_token: sessionToken || undefined,\r\n      email: user?.email || customUser?.email || undefined,\r\n      phone: customUser?.phone || undefined,\r\n      name: profile?.full_name || customUser?.full_name || user?.user_metadata?.full_name || undefined,\r\n      source: 'web-chat',\r\n    };\r\n\r\n    // Add user message to conversation history\r\n    conversationHistory.current.push({\r\n      role: 'user',\r\n      content: message\r\n    });\r\n\r\n    try {\r\n      // DEBUG: Log what we're sending to backend\r\n      if (options?.mediaPaths) {\r\n        console.log('üñºÔ∏è  Sending media_paths to backend:', options.mediaPaths);\r\n        console.log('üñºÔ∏è  Sending media_type to backend:', options.mediaType);\r\n      }\r\n      \r\n      const response = await fetch(`${AGENT_BACKEND_URL}/web-chat`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          message,\r\n          user_id: resolvedUserId,\r\n          conversation_history: conversationHistory.current,\r\n          user_context: userContext,\r\n          media_paths: options?.mediaPaths,\r\n          media_type: options?.mediaType,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        console.error('Backend error response:', errorText);\r\n        throw new Error(`Backend hatasƒ± (${response.status}): ${errorText || 'Bilinmeyen hata'}`);\r\n      }\r\n\r\n      setIsConnecting(false);\r\n\r\n      // Check if response is SSE\r\n      const contentType = response.headers.get('content-type');\r\n      if (!contentType?.includes('text/event-stream')) {\r\n        console.error('Invalid content type:', contentType);\r\n        throw new Error('Backend yanlƒ±≈ü format d√∂nd√º. SSE bekleniyor.');\r\n      }\r\n\r\n      // Read SSE stream\r\n      const reader = response.body?.getReader();\r\n      const decoder = new TextDecoder();\r\n\r\n      if (!reader) {\r\n        throw new Error('Response body okunamƒ±yor');\r\n      }\r\n\r\n      let aiMessageId = Date.now().toString();\r\n      let buffer = '';\r\n\r\n      while (true) {\r\n        const { done, value } = await reader.read();\r\n        \r\n        if (done) {\r\n          // Parse listings from final message\r\n          const { cleanContent, listings } = parseListings(currentMessageRef.current);\r\n          \r\n          // Add AI response to conversation history\r\n          if (cleanContent) {\r\n            conversationHistory.current.push({\r\n              role: 'assistant',\r\n              content: cleanContent\r\n            });\r\n          }\r\n\r\n          // Update message with parsed data\r\n          setMessages((prev) => {\r\n            const updated = [...prev];\r\n            const index = updated.findIndex(m => m.id === aiMessageId);\r\n            if (index >= 0) {\r\n              updated[index] = {\r\n                ...updated[index],\r\n                content: cleanContent,\r\n                listings: listings.length > 0 ? listings : undefined,\r\n              };\r\n            }\r\n            return updated;\r\n          });\r\n\r\n          setIsTyping(false);\r\n\r\n          // Immediately speak response in voice mode (no delay)\r\n          if (voiceMode && (window as any).speakResponse && cleanContent) {\r\n            console.log('üîä Speaking response immediately after streaming...');\r\n            setTimeout(() => (window as any).speakResponse(cleanContent), 100);\r\n          }\r\n\r\n          break;\r\n        }\r\n\r\n        buffer += decoder.decode(value, { stream: true });\r\n        const lines = buffer.split('\\n');\r\n        buffer = lines.pop() || '';\r\n\r\n        for (const line of lines) {\r\n          if (line.startsWith('data: ')) {\r\n            try {\r\n              const data = JSON.parse(line.slice(6));\r\n              \r\n              if (data.type === 'text' && data.content) {\r\n                currentMessageRef.current += data.content;\r\n                \r\n                // Update or create AI message\r\n                setMessages((prev) => {\r\n                  const existingIndex = prev.findIndex(m => m.id === aiMessageId);\r\n                  if (existingIndex >= 0) {\r\n                    const updated = [...prev];\r\n                    updated[existingIndex] = {\r\n                      ...updated[existingIndex],\r\n                      content: currentMessageRef.current,\r\n                    };\r\n                    return updated;\r\n                  } else {\r\n                    return [\r\n                      ...prev,\r\n                      {\r\n                        id: aiMessageId,\r\n                        type: 'ai',\r\n                        content: currentMessageRef.current,\r\n                        timestamp: new Date(),\r\n                      },\r\n                    ];\r\n                  }\r\n                });\r\n              } else if (data.type === 'done') {\r\n                // Streaming complete\r\n                setIsTyping(false);\r\n              } else if (data.type === 'error') {\r\n                throw new Error(data.content || 'Backend hatasƒ± olu≈ütu');\r\n              }\r\n            } catch (parseError) {\r\n              console.error('SSE parse hatasƒ±:', parseError, 'Line:', line);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Agent baƒülantƒ± hatasƒ±:', err);\r\n      \r\n      // Determine error type and message\r\n      let errorMessage = 'Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.';\r\n      \r\n      if (err.name === 'TypeError' && err.message.includes('fetch')) {\r\n        errorMessage = 'Backend\\'e ula≈üƒ±lamƒ±yor. CORS veya network hatasƒ± olabilir.';\r\n      } else if (err.message) {\r\n        errorMessage = err.message;\r\n      }\r\n      \r\n      setError(errorMessage);\r\n      setIsTyping(false);\r\n      setIsConnecting(false);\r\n      \r\n      // Add error message\r\n      const errorAiMessage: Message = {\r\n        id: (Date.now() + 1).toString(),\r\n        type: 'ai',\r\n        content: '‚ö†Ô∏è √úzg√ºn√ºm, ≈üu anda baƒülantƒ± kuramƒ±yorum. Backend servisi √ßalƒ±≈üƒ±yor mu kontrol edin. L√ºtfen daha sonra tekrar deneyin.',\r\n        timestamp: new Date(),\r\n      };\r\n      setMessages((prev) => [...prev, errorAiMessage]);\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = () => {\r\n    if (!inputValue.trim()) return;\r\n\r\n    const newMessage: Message = {\r\n      id: Date.now().toString(),\r\n      type: 'user',\r\n      content: inputValue,\r\n      timestamp: new Date(),\r\n    };\r\n\r\n    setMessages((prev) => [...prev, newMessage]);\r\n    const messageToSend = inputValue;\r\n    setInputValue('');\r\n    \r\n    // Send to agent backend\r\n    sendMessageToAgent(messageToSend);\r\n  };\r\n\r\n  const handleQuickAction = (action: string) => {\r\n    const quickMessages: Record<string, string> = {\r\n      'create': 'Yeni bir ilan olu≈üturmak istiyorum',\r\n      'price': '√úr√ºn√ºm i√ßin fiyat √∂nerisi alabilir miyim?',\r\n      'improve': 'ƒ∞lan metnini iyile≈ütirmek istiyorum',\r\n      'search': 'T√ºm ilanlarƒ± g√∂ster',\r\n      'seller': 'Satƒ±cƒ± bulmak istiyorum',\r\n      'help': 'Yardƒ±m almak istiyorum',\r\n    };\r\n\r\n    const message = quickMessages[action];\r\n    if (message) {\r\n      const newMessage: Message = {\r\n        id: Date.now().toString(),\r\n        type: 'user',\r\n        content: message,\r\n        timestamp: new Date(),\r\n      };\r\n      setMessages((prev) => [...prev, newMessage]);\r\n      sendMessageToAgent(message);\r\n    }\r\n  };\r\n\r\n  const handleFileUpload = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      const fileSizeMB = file.size / (1024 * 1024);\r\n\r\n      // Dosya tipi kontrol√º\r\n      if (file.type.startsWith('image/')) {\r\n        const handleUpload = async (uploadFile: File) => {\r\n          const resolvedUserId = customUser?.id || user?.id || localStorage.getItem('user_id') || getUserId();\r\n          try {\r\n            setIsTyping(true);\r\n            const { storagePath, publicUrl } = await uploadImageToSupabase(uploadFile, resolvedUserId);\r\n\r\n            const uploadedMessage: Message = {\r\n              id: Date.now().toString(),\r\n              type: 'user',\r\n              content: `üì∑ ${uploadFile.name} y√ºklendi (${(uploadFile.size / (1024 * 1024)).toFixed(2)} MB)`,\r\n              timestamp: new Date(),\r\n            };\r\n            setMessages((prev) => [...prev, uploadedMessage]);\r\n\r\n            // Send note to agent with media_paths\r\n            // Use storagePath (not publicUrl) - backend will resolve to public URL\r\n            console.log('üì∏ Uploading image - storagePath:', storagePath, 'publicUrl:', publicUrl);\r\n            sendMessageToAgent(`Fotoƒüraf y√ºkledim: ${uploadFile.name}`, {\r\n              mediaPaths: [storagePath],\r\n              mediaType: uploadFile.type,\r\n            });\r\n\r\n            // Ek bilgilendirme mesajƒ± (optional)\r\n            const infoMessage: Message = {\r\n              id: (Date.now() + 2).toString(),\r\n              type: 'ai',\r\n              content: 'üì• G√∂rsel y√ºklendi, √ºr√ºn analizi ba≈ülatƒ±lƒ±yor...',\r\n              timestamp: new Date(),\r\n            };\r\n            setMessages((prev) => [...prev, infoMessage]);\r\n          } catch (uploadErr: any) {\r\n            console.error('Upload error:', uploadErr);\r\n            const errorMessage: Message = {\r\n              id: (Date.now() + 3).toString(),\r\n              type: 'ai',\r\n              content: `‚ö†Ô∏è G√∂rsel y√ºklenemedi: ${uploadErr?.message || 'Bilinmeyen hata'}`,\r\n              timestamp: new Date(),\r\n            };\r\n            setMessages((prev) => [...prev, errorMessage]);\r\n          } finally {\r\n            setIsTyping(false);\r\n          }\r\n        };\r\n\r\n        // Resim sƒ±kƒ±≈ütƒ±rma\r\n        if (fileSizeMB > 0.9) {\r\n          setIsTyping(true);\r\n          const userMessage: Message = {\r\n            id: Date.now().toString(),\r\n            type: 'user',\r\n            content: `üì∑ ${file.name} i≈üleniyor...`,\r\n            timestamp: new Date(),\r\n          };\r\n          setMessages((prev) => [...prev, userMessage]);\r\n\r\n          compressImage(file, 0.9)\r\n            .then((compressedFile) => {\r\n              const compressedSizeMB = (compressedFile.size / (1024 * 1024)).toFixed(2);\r\n              const updatedMessage: Message = {\r\n                id: Date.now().toString(),\r\n                type: 'user',\r\n                content: `üì∑ ${file.name} y√ºklendi (${compressedSizeMB} MB)`,\r\n                timestamp: new Date(),\r\n              };\r\n              setMessages((prev) => {\r\n                const filtered = prev.filter(m => m.id !== userMessage.id);\r\n                return [...filtered, updatedMessage];\r\n              });\r\n\r\n              handleUpload(compressedFile);\r\n            })\r\n            .catch((error) => {\r\n              console.error('Resim sƒ±kƒ±≈ütƒ±rma hatasƒ±:', error);\r\n              const errorMessage: Message = {\r\n                id: (Date.now() + 1).toString(),\r\n                type: 'ai',\r\n                content: '‚ö†Ô∏è Resim i≈ülenirken bir hata olu≈ütu. L√ºtfen tekrar deneyin.',\r\n                timestamp: new Date(),\r\n              };\r\n              setMessages((prev) => [...prev, errorMessage]);\r\n              setIsTyping(false);\r\n            });\r\n        } else {\r\n          handleUpload(file);\r\n        }\r\n      } else if (file.type.startsWith('video/')) {\r\n        // Video boyut kontrol√º (max 5 MB)\r\n        if (fileSizeMB > 5) {\r\n          const errorMessage: Message = {\r\n            id: Date.now().toString(),\r\n            type: 'ai',\r\n            content: `‚ö†Ô∏è ${file.name} √ßok b√ºy√ºk! Videolar maksimum 5 MB olmalƒ±dƒ±r. (Mevcut: ${fileSizeMB.toFixed(2)} MB)`,\r\n            timestamp: new Date(),\r\n          };\r\n          setMessages((prev) => [...prev, errorMessage]);\r\n          return;\r\n        }\r\n\r\n        const newMessage: Message = {\r\n          id: Date.now().toString(),\r\n          type: 'user',\r\n          content: `üé• ${file.name} y√ºklendi (${fileSizeMB.toFixed(2)} MB)`,\r\n          timestamp: new Date(),\r\n        };\r\n        setMessages((prev) => [...prev, newMessage]);\r\n\r\n        // TODO: Implement video upload to agent backend\r\n        setIsTyping(true);\r\n        setTimeout(() => {\r\n          const aiResponse: Message = {\r\n            id: (Date.now() + 1).toString(),\r\n            type: 'ai',\r\n            content: 'Video y√ºkleme √∂zelliƒüi yakƒ±nda aktif olacak!',\r\n            timestamp: new Date(),\r\n          };\r\n          setMessages((prev) => [...prev, aiResponse]);\r\n          setIsTyping(false);\r\n        }, 1500);\r\n      } else {\r\n        const errorMessage: Message = {\r\n          id: Date.now().toString(),\r\n          type: 'ai',\r\n          content: '‚ö†Ô∏è Sadece resim ve video dosyalarƒ± y√ºkleyebilirsiniz.',\r\n          timestamp: new Date(),\r\n        };\r\n        setMessages((prev) => [...prev, errorMessage]);\r\n      }\r\n    }\r\n  };\r\n\r\n  const toggleVoiceMode = () => {\r\n    setVoiceMode(!voiceMode);\r\n  };\r\n\r\n  const handleVoiceTranscript = (text: string) => {\r\n    // Add corrected voice text as user message\r\n    const newMessage: Message = {\r\n      id: Date.now().toString(),\r\n      type: 'user',\r\n      content: text,\r\n      timestamp: new Date(),\r\n    };\r\n    setMessages((prev) => [...prev, newMessage]);\r\n    \r\n    // Send to agent\r\n    sendMessageToAgent(text);\r\n  };\r\n\r\n  // Removed: Speech is now triggered immediately in sendMessageToAgent\r\n\r\n  const toggleRecording = () => {\r\n    setIsRecording(!isRecording);\r\n    if (!isRecording) {\r\n      setTimeout(() => {\r\n        setIsRecording(false);\r\n        const newMessage: Message = {\r\n          id: Date.now().toString(),\r\n          type: 'user',\r\n          content: 'üé§ Sesli mesaj kaydedildi',\r\n          timestamp: new Date(),\r\n        };\r\n        setMessages((prev) => [...prev, newMessage]);\r\n        \r\n        // TODO: Implement voice message to agent backend\r\n        setIsTyping(true);\r\n        setTimeout(() => {\r\n          const aiResponse: Message = {\r\n            id: (Date.now() + 1).toString(),\r\n            type: 'ai',\r\n            content: 'Sesli mesaj √∂zelliƒüi yakƒ±nda aktif olacak!',\r\n            timestamp: new Date(),\r\n          };\r\n          setMessages((prev) => [...prev, aiResponse]);\r\n          setIsTyping(false);\r\n        }, 1500);\r\n      }, 3000);\r\n    }\r\n  };\r\n\r\n  const quickActions = [\r\n    { id: 'create', icon: 'ri-add-circle-line', label: 'ƒ∞lan Olu≈ütur', color: 'from-purple-500 to-blue-500' },\r\n    { id: 'search', icon: 'ri-search-line', label: 'ƒ∞lan Ara', color: 'from-cyan-500 to-green-500' },\r\n    { id: 'improve', icon: 'ri-edit-line', label: 'Metni ƒ∞yile≈ütir', color: 'from-orange-500 to-pink-500' },\r\n  ];\r\n\r\n  const renderListingCard = (listing: any) => {\r\n    const supabaseUrl = import.meta.env.VITE_PUBLIC_SUPABASE_URL;\r\n    const imageUrls = listing.signed_images?.map((imagePath: string) => {\r\n      if (imagePath.startsWith('http')) {\r\n        return imagePath;\r\n      }\r\n      return `${supabaseUrl}/storage/v1/object/public/product-images/${imagePath}`;\r\n    }) || [];\r\n\r\n    const mainImage = imageUrls[0] || 'https://readdy.ai/api/search-image?query=product%20placeholder%20simple%20clean%20background&width=400&height=300&seq=placeholder&orientation=landscape';\r\n\r\n    return (\r\n      <div\r\n        key={listing.id}\r\n        onClick={() => handleListingClick(listing.id)}\r\n        className=\"bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition-all cursor-pointer border border-gray-100\"\r\n      >\r\n        <div className=\"flex items-start space-x-3\">\r\n          {/* Ana Resim */}\r\n          <div className=\"w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden bg-gray-100\">\r\n            <img\r\n              src={mainImage}\r\n              alt={listing.title}\r\n              className=\"w-full h-full object-cover\"\r\n            />\r\n          </div>\r\n\r\n          {/* ƒ∞lan Bilgileri */}\r\n          <div className=\"flex-1 min-w-0\">\r\n            <h4 className=\"text-sm font-semibold text-gray-900 mb-1 truncate\">\r\n              {listing.title}\r\n            </h4>\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <span className=\"text-lg font-bold text-purple-600\">\r\n                {listing.price?.toLocaleString('tr-TR')} ‚Ç∫\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center text-xs text-gray-500 mb-2\">\r\n              <i className=\"ri-map-pin-line mr-1\" />\r\n              {listing.location}\r\n            </div>\r\n            {listing.category && (\r\n              <span className=\"inline-block px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full\">\r\n                {listing.category}\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Resim Galerisi */}\r\n        {imageUrls.length > 1 && (\r\n          <div className=\"mt-3 pt-3 border-t border-gray-100\">\r\n            <div className=\"flex space-x-2 overflow-x-auto\">\r\n              {imageUrls.slice(0, 3).map((img: string, idx: number) => (\r\n                <a\r\n                  key={idx}\r\n                  href={img}\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                  onClick={(e) => e.stopPropagation()}\r\n                  className=\"w-16 h-16 flex-shrink-0 rounded-md overflow-hidden bg-gray-100 hover:ring-2 hover:ring-purple-500 transition-all\"\r\n                >\r\n                  <img\r\n                    src={img}\r\n                    alt={`${listing.title} - ${idx + 1}`}\r\n                    className=\"w-full h-full object-cover\"\r\n                  />\r\n                </a>\r\n              ))}\r\n              {imageUrls.length > 3 && (\r\n                <div className=\"w-16 h-16 flex-shrink-0 rounded-md bg-gray-100 flex items-center justify-center text-xs text-gray-600 font-medium\">\r\n                  +{imageUrls.length - 3}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderListingCards = (listings: any[]) => {\r\n    return (\r\n      <div className=\"space-y-3 mt-2\">\r\n        {listings.slice(0, displayCount).map((listing) => renderListingCard(listing))}\r\n\r\n        {/* Daha Fazla G√∂ster Butonu */}\r\n        {listings.length > displayCount && (\r\n          <button\r\n            onClick={() => setDisplayCount(prev => prev + 3)}\r\n            className=\"w-full py-2 text-sm text-purple-600 hover:text-purple-700 font-medium transition-colors\"\r\n          >\r\n            Daha fazla g√∂ster ({listings.length - displayCount} ilan daha)\r\n          </button>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderMessage = (msg: Message) => {\r\n    const isUser = msg.role === 'user';\r\n    \r\n    // Parse listings from message\r\n    let listings: any[] = [];\r\n    let cleanContent = msg.content;\r\n    \r\n    const cacheMatch = msg.content.match(/\\[SEARCH_CACHE\\]({.*})/s);\r\n    if (cacheMatch) {\r\n      try {\r\n        const cacheData = JSON.parse(cacheMatch[1]);\r\n        listings = cacheData.results || [];\r\n        cleanContent = msg.content.replace(/\\[SEARCH_CACHE\\]({.*})/s, '').trim();\r\n      } catch (e) {\r\n        console.error('Failed to parse listings:', e);\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div\r\n        key={msg.id}\r\n        className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-4`}\r\n      >\r\n        <div className={`flex items-start space-x-2 max-w-[85%] ${isUser ? 'flex-row-reverse space-x-reverse' : ''}`}>\r\n          <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${\r\n            isUser ? 'bg-purple-600' : 'bg-gray-200'\r\n          }`}>\r\n            <i className={`${isUser ? 'ri-user-line text-white' : 'ri-robot-line text-gray-600'}`}></i>\r\n          </div>\r\n          <div className=\"flex flex-col space-y-2 flex-1 min-w-0\">\r\n            <div\r\n              className={`px-4 py-3 rounded-2xl break-words whitespace-pre-wrap ${\r\n                isUser\r\n                  ? 'bg-purple-600 text-white rounded-tr-none'\r\n                  : 'bg-gray-100 text-gray-900 rounded-tl-none'\r\n              }`}\r\n            >\r\n              {cleanContent}\r\n            </div>\r\n            \r\n            {/* Render Listings */}\r\n            {listings.length > 0 && (\r\n              <div className=\"space-y-2\">\r\n                {listings.slice(0, 3).map((listing) => renderListingCard(listing))}\r\n                {listings.length > 3 && (\r\n                  <button\r\n                    onClick={() => navigate('/listings')}\r\n                    className=\"w-full py-2 text-sm text-purple-600 hover:text-purple-700 font-medium transition-colors\"\r\n                  >\r\n                    T√ºm ƒ∞lanlarƒ± G√∂r ({listings.length} ilan)\r\n                  </button>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* FAB Button */}\r\n      <AnimatePresence>\r\n        {!isOpen && (\r\n          <motion.button\r\n            initial={{ scale: 0 }}\r\n            animate={{ scale: 1 }}\r\n            exit={{ scale: 0 }}\r\n            onClick={() => setIsOpen(true)}\r\n            className=\"fixed bottom-6 right-6 w-16 h-16 bg-gradient-primary rounded-full shadow-2xl flex items-center justify-center z-50 hover:scale-110 transition-transform animate-pulse-slow cursor-pointer\"\r\n          >\r\n            <i className=\"ri-chat-ai-line text-3xl text-white\" />\r\n          </motion.button>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Chat Modal */}\r\n      <AnimatePresence>\r\n        {isOpen && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 20, scale: 0.95 }}\r\n            animate={{ opacity: 1, y: 0, scale: 1 }}\r\n            exit={{ opacity: 0, y: 20, scale: 0.95 }}\r\n            className=\"fixed bottom-6 right-6 w-[440px] h-[700px] bg-white rounded-3xl shadow-2xl z-50 flex flex-col overflow-hidden\"\r\n          >\r\n            {/* Header */}\r\n            <div className=\"bg-gradient-primary p-4 flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center\">\r\n                  <i className=\"ri-robot-2-fill text-2xl text-white\" />\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-white font-semibold\">PazarAI Asistan</div>\r\n                  <div className=\"flex items-center space-x-1 text-white/80 text-xs\">\r\n                    <div className={`w-2 h-2 rounded-full ${isConnecting ? 'bg-yellow-400' : 'bg-green-400'} animate-pulse`} />\r\n                    <span>{isConnecting ? 'Baƒülanƒ±yor...' : '√áevrimi√ßi'}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2\">\r\n                {/* Voice Selector - Shows when voice mode is enabled */}\r\n                {voiceMode && (\r\n                  <VoiceSelector\r\n                    selectedVoice={selectedVoice}\r\n                    onVoiceSelect={setSelectedVoice}\r\n                  />\r\n                )}\r\n                \r\n                <button\r\n                  onClick={toggleVoiceMode}\r\n                  title={voiceMode ? \"Sesli Modu Kapat\" : \"Sesli Modu A√ß\"}\r\n                  className={`w-8 h-8 rounded-full flex items-center justify-center transition-colors cursor-pointer ${\r\n                    voiceMode ? 'bg-white/30 text-white' : 'hover:bg-white/20 text-white/80'\r\n                  }`}\r\n                >\r\n                  <i className={`${voiceMode ? 'ri-volume-up-fill' : 'ri-volume-mute-line'} text-xl`} />\r\n                </button>\r\n                <button\r\n                  onClick={() => setIsOpen(false)}\r\n                  title=\"K√º√ß√ºlt\"\r\n                  className=\"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors cursor-pointer\"\r\n                >\r\n                  <i className=\"ri-subtract-line text-white text-xl\" />\r\n                </button>\r\n                <button\r\n                  onClick={() => setIsOpen(false)}\r\n                  title=\"Kapat\"\r\n                  className=\"w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors cursor-pointer\"\r\n                >\r\n                  <i className=\"ri-close-line text-white text-xl\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Tabs */}\r\n            <div className=\"flex border-b border-gray-200 bg-gray-50\">\r\n              {[\r\n                { id: 'general', label: 'Genel Sohbet' },\r\n                { id: 'listing', label: 'ƒ∞lan Asistanƒ±' },\r\n                { id: 'support', label: 'Destek' },\r\n              ].map((tab) => (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => setActiveTab(tab.id as Tab)}\r\n                  className={`flex-1 py-3 text-sm font-medium transition-colors relative whitespace-nowrap cursor-pointer ${\r\n                    activeTab === tab.id ? 'text-purple-600' : 'text-gray-600 hover:text-gray-900'\r\n                  }`}\r\n                >\r\n                  {tab.label}\r\n                  {activeTab === tab.id && (\r\n                    <motion.div\r\n                      layoutId=\"activeTab\"\r\n                      className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-primary\"\r\n                    />\r\n                  )}\r\n                </button>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Error Banner */}\r\n            {error && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: -10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                className=\"bg-red-50 border-b border-red-200 px-4 py-2 flex items-center justify-between\"\r\n              >\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <i className=\"ri-error-warning-line text-red-500\" />\r\n                  <span className=\"text-sm text-red-700\">{error}</span>\r\n                </div>\r\n                <button\r\n                  onClick={() => setError(null)}\r\n                  className=\"text-red-500 hover:text-red-700 cursor-pointer\"\r\n                  aria-label=\"Hatayƒ± kapat\"\r\n                >\r\n                  <i className=\"ri-close-line\" />\r\n                </button>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* Messages */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50\">\r\n              {messages.map((message) => (\r\n                <motion.div\r\n                  key={message.id}\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}\r\n                >\r\n                  <div className=\"max-w-[85%] space-y-2\">\r\n                    <div\r\n                      className={`rounded-2xl px-4 py-3 ${\r\n                        message.type === 'user'\r\n                          ? 'bg-gradient-primary text-white'\r\n                          : 'bg-white text-gray-800 shadow-md'\r\n                      }`}\r\n                    >\r\n                      <p className=\"text-sm leading-relaxed whitespace-pre-wrap break-words\">\r\n                        {message.content\r\n                          .replace(/Fotoƒüraflar:\\s*https?:\\/\\/[^\\s]+/g, '')\r\n                          .replace(/https?:\\/\\/[^\\s]+/g, '')\r\n                          .replace(/\\n{3,}/g, '\\n\\n')\r\n                          .trim()}\r\n                      </p>\r\n                    </div>\r\n\r\n                    {/* Listing Cards */}\r\n                    {message.listings && message.listings.length > 0 && renderListingCards(message.listings)}\r\n                  </div>\r\n                </motion.div>\r\n              ))}\r\n\r\n              {isTyping && (\r\n                <motion.div\r\n                  initial={{ opacity: 0 }}\r\n                  animate={{ opacity: 1 }}\r\n                  className=\"flex justify-start\"\r\n                >\r\n                  <div className=\"bg-white rounded-2xl px-4 py-3 shadow-md\">\r\n                    <div className=\"flex space-x-2\">\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" />\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce [animation-delay:200ms]\" />\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce [animation-delay:400ms]\" />\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n\r\n              {/* Quick Actions */}\r\n              {activeTab === 'listing' && messages.length <= 2 && !isTyping && (\r\n                <div className=\"space-y-2 pt-4\">\r\n                  <p className=\"text-xs text-gray-500 text-center mb-3\">Hƒ±zlƒ± ƒ∞≈ülemler</p>\r\n                  {quickActions.map((action, index) => (\r\n                    <motion.button\r\n                      key={index}\r\n                      initial={{ opacity: 0, x: -20 }}\r\n                      animate={{ opacity: 1, x: 0 }}\r\n                      transition={{ delay: index * 0.1 }}\r\n                      onClick={() => handleQuickAction(action.id)}\r\n                      className={`w-full py-3 px-4 bg-gradient-to-r ${action.color} text-white rounded-xl hover:shadow-lg transition-all flex items-center space-x-3 whitespace-nowrap cursor-pointer`}\r\n                    >\r\n                      <i className={`${action.icon} text-xl`} />\r\n                      <span className=\"text-sm font-medium\">{action.label}</span>\r\n                    </motion.button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              <div ref={messagesEndRef} />\r\n            </div>\r\n\r\n            {/* Input Area */}\r\n            <div className=\"p-4 bg-white border-t border-gray-200\">\r\n              {isRecording && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  className=\"mb-3 flex items-center justify-center space-x-3 py-2\"\r\n                >\r\n                  <div className=\"flex space-x-1\">\r\n                    {[...Array(5)].map((_, i) => (\r\n                      <motion.div\r\n                        key={i}\r\n                        className=\"w-1 bg-red-500 rounded-full\"\r\n                        animate={{ height: [8, 24, 8] }}\r\n                        transition={{ duration: 0.8, repeat: Infinity, delay: i * 0.1 }}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                  <span className=\"text-sm text-red-500 font-medium\">Kaydediliyor...</span>\r\n                </motion.div>\r\n              )}\r\n\r\n              <div className=\"flex items-center space-x-2\">\r\n                <input\r\n                  type=\"file\"\r\n                  ref={fileInputRef}\r\n                  onChange={handleFileChange}\r\n                  accept=\"image/*\"\r\n                  className=\"hidden\"\r\n                  aria-label=\"Fotoƒüraf se√ß\"\r\n                />\r\n                <button\r\n                  onClick={handleFileUpload}\r\n                  disabled={isTyping}\r\n                  className=\"w-10 h-10 flex items-center justify-center text-gray-600 hover:bg-gray-100 rounded-full transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  aria-label=\"Fotoƒüraf y√ºkle\"\r\n                >\r\n                  <i className=\"ri-attachment-line text-xl\" />\r\n                </button>\r\n\r\n                <textarea\r\n                  value={inputValue}\r\n                  onChange={(e) => setInputValue(e.target.value)}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === 'Enter' && !e.shiftKey) {\r\n                      e.preventDefault();\r\n                      handleSendMessage();\r\n                    }\r\n                  }}\r\n                  placeholder={voiceMode ? \"üé§ Sesli mod aktif - Mikrofona konu≈üun veya yazƒ±n\" : \"Mesajƒ±nƒ±zƒ± yazƒ±n...\"}\r\n                  disabled={isTyping}\r\n                  className=\"flex-1 px-4 py-2 border border-gray-300 rounded-full resize-none focus:outline-none focus:border-purple-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\r\n                  rows={1}\r\n                />\r\n\r\n                {/* Voice Chat Button (when voice mode active) */}\r\n                {voiceMode && (\r\n                  <div className=\"relative\">\r\n                    <VoiceChat\r\n                      onTranscriptReady={handleVoiceTranscript}\r\n                      isEnabled={voiceMode}\r\n                      selectedVoice={selectedVoice}\r\n                    />\r\n                  </div>\r\n                )}\r\n                \r\n                <button\r\n                  onClick={handleSendMessage}\r\n                  disabled={!inputValue.trim() || isTyping}\r\n                  title=\"G√∂nder\"\r\n                  className=\"w-10 h-10 bg-gradient-primary text-white rounded-full flex items-center justify-center hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer\"\r\n                >\r\n                  <i className=\"ri-send-plane-fill text-lg\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </>\r\n  );\r\n}\r\n"],"names":["PopChildMeasure","React.Component","prevProps","element","parent","parentWidth","isHTMLElement","size","PopChild","children","isPresent","anchorX","root","id","useId","ref","useRef","nonce","useContext","MotionConfigContext","useInsertionEffect","width","height","top","left","right","x","style","jsx","React.cloneElement","PresenceChild","initial","onExitComplete","custom","presenceAffectsLayout","mode","presenceChildren","useConstant","newChildrenMap","isReusedContext","context","useMemo","childId","isComplete","_","key","React.useEffect","PresenceContext","getChildKey","child","onlyElements","filtered","Children","isValidElement","AnimatePresence","propagate","isParentPresent","safeToRemove","usePresence","presentChildren","presentKeys","isInitialRender","pendingPresentChildren","exitComplete","diffedChildren","setDiffedChildren","useState","renderedChildren","setRenderedChildren","useIsomorphicLayoutEffect","i","exitingChildren","nextChildren","forceRender","LayoutGroupContext","Fragment","onExit","isEveryExitComplete","isExitComplete","createStoreImpl","createState","state","listeners","setState","partial","replace","nextState","previousState","listener","getState","api","initialState","createStore","identity","arg","useStore","selector","slice","React","createImpl","useBoundStore","create","useAuthStore","set","get","sessionToken","userId","data","error","supabase","userData","user","email","password","authHelpers","profileData","fullName","updates","event","session","VoiceChat","onTranscriptReady","onResponseReceived","isEnabled","externalSelectedVoice","isListening","setIsListening","transcript","setTranscript","correctedText","setCorrectedText","isCorrecting","setIsCorrecting","setError","isSpeaking","setIsSpeaking","internalSelectedVoice","setInternalSelectedVoice","selectedVoice","recognitionRef","synthRef","useEffect","SpeechRecognition","finalTranscript","corrected","correctBrandNames","stopListening","loadDefaultVoice","turkishVoices","preferredVoice","v","startListening","err","convertNumberToWords","num","ones","tens","hundreds","ten","one","hundred","remainder","text","brandMap","wrong","correct","regex","speak","useCallback","cleanText","_match","n","word","match","p1","p2","p3","digits","part1","d","part2","part3","currency","thousands","result","utterance","e","stopSpeaking","jsxs","motion","VoiceSelector","onVoiceSelect","voices","setVoices","showMenu","setShowMenu","loadVoices","availableVoices","voicesToUse","voice","index","icon","supabaseUrl","supabaseAnonKey","createClient","PUBLIC_BUCKET","getUserId","parseListings","content","searchCacheMatch","cacheData","compressImage","file","maxSizeMB","resolve","reject","reader","img","canvas","maxDimension","quality","maxSizeBytes","tryCompress","q","blob","compressedFile","ChatBox","navigate","useNavigate","customUser","profile","checkAuth","isOpen","setIsOpen","activeTab","setActiveTab","messages","setMessages","inputValue","setInputValue","isRecording","setIsRecording","isTyping","setIsTyping","isConnecting","setIsConnecting","displayCount","setDisplayCount","voiceMode","setVoiceMode","setSelectedVoice","messagesEndRef","fileInputRef","currentMessageRef","conversationHistory","AGENT_BACKEND_URL","resolveUserIdPath","uploadImageToSupabase","resolvedUserId","sanitizedUser","filename","storagePath","publicUrl","scrollToBottom","handleListingClick","listingId","sendMessageToAgent","message","options","storedUserId","userContext","response","errorText","contentType","decoder","aiMessageId","buffer","done","value","cleanContent","listings","prev","updated","m","lines","line","existingIndex","parseError","errorMessage","errorAiMessage","handleSendMessage","newMessage","messageToSend","handleQuickAction","action","handleFileUpload","handleFileChange","fileSizeMB","handleUpload","uploadFile","uploadedMessage","infoMessage","uploadErr","userMessage","compressedSizeMB","updatedMessage","aiResponse","toggleVoiceMode","handleVoiceTranscript","quickActions","renderListingCard","listing","imageUrls","imagePath","mainImage","idx","renderListingCards","tab"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}